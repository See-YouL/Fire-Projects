/**                             
  ******************************************************************************
  **--------------------------------------------------------------------------**
  ** @FileName      : main.c  
  ** @Brief         : 通过结构体访问寄存器
  **--------------------------------------------------------------------------**
  ** @Author Data   : Eric 2023-12-29
  ** @Version       : v1.0				
  **--------------------------------------------------------------------------**
  ** @Function List : None
  **--------------------------------------------------------------------------**
  ** @Attention     : Complier(V.6.19)
  **--------------------------------------------------------------------------**
  ******************************************************************************
  *
 **/
#include "stm32f10x.h"


int main(void)
{
// 注释上节课代码
#if 0
  *(unsigned int *)(0x40021018) |= ((1) << 3); // RCC_APB2ENR的bit3置1
  /*----------------------------------------------------------------
  开启GPIOB的时钟
  GPIOB挂载在APB2总线
  RCC_APB2ENR的偏移量为0x18
  RCC的基地址为0x40021000
  RCC_APB2ENR的bit3为IOPBEN(IO端口B时钟使能) 1开启
  ****************************************************************************/
  *(unsigned int *)(0x40010C00) |= ((1) << (4*0)); // GPIOB_CRL的bit4-0置0001
  /*----------------------------------------------------------------
  将GPIOB设置为推挽输出
  GPIOB 基地址 0x40010C00
  GPIOx_CRL 偏移量 00h 
  bit1-0: 01 输出模式，最大速度10MHz
  bit4-3: 00 通用推挽输出模式
  ((1) << (4*0)) // 若修改PB1则为(4*1)
  ****************************************************************************/
  *(unsigned int *)(0x40010C0C) &= ~(1<<0); // GPIOB_ODR的bit0置0
  /*----------------------------------------------------------------
  修改PB0为1
  GPIOB 基地址 0x40010C00
  GPIOx_ODR 偏移量 0Ch 
  ****************************************************************************/
#else

  RCC_APB2ENR |= ((1) << 3); // 开启GPIOB的时钟
  GPIOB_CRL &= ~((0x0F) << (4*0)); // 将GPIOB状态复位
  GPIOB_CRL |= ((1) << (4*0)); // 将GPIOB设置为推挽输出
  GPIOB_ODR &= ~(1<<0); // PB0置0

#endif
}

// Arm6 编译器不需要下面的操作
void SystemInit(void)
{
    // 函数体为空，目的是骗过编译器不报错
}
