<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>24-I2C-EEPROM读写实验: I2C-读写EEPROM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">24-I2C-EEPROM读写实验<span id="projectnumber">&#160;None</span>
   </div>
   <div id="projectbrief">I2C-EEPROM读写实验</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">I2C-读写EEPROM</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> </p>
<h2><a class="anchor" id="autotoc_md1"></a>
补充: I2C简介</h2>
<p>I2C（Inter-Integrated Circuit）是一种串行通信协议，**用于在集成电路之间进行短距离通信** I2C 由飞利浦公司（Philips）于1982年开发，并且现在由多家公司支持和采用。该协议通常用于连接芯片、传感器、存储器、外设等设备。</p>
<p>以下是 I2C 协议的一些关键特点和基本概念：</p>
<ol type="1">
<li>总线结构<ul>
<li>主从结构： I2C 使用主从结构，其中一个设备充当主设备（通常是微控制器或处理器），而其他设备则充当从设备。主设备负责发起通信和生成时钟信号。</li>
<li>双线制： I2C 使用两根线，一根是数据线（SDA），另一根是时钟线（SCL）。这两根线上都有上拉电阻，以便在设备不主动拉低时保持高电平。</li>
</ul>
</li>
<li>数据传输：<ul>
<li>起始和停止条件： 数据传输始于主设备发送起始条件（Start Condition），并以主设备发送停止条件（Stop Condition）结束。这两个条件都是由主设备在总线上生成的。</li>
<li>地址帧： 每个数据传输都以地址帧开始，其中包含目标设备的地址和读写位。地址帧由主设备发送。</li>
<li>数据帧： 在地址帧之后是一个或多个数据帧，其中包含实际的数据。数据帧的传输由主设备和从设备之间交替进行。</li>
<li>应答（Acknowledge）： 在每个数据帧之后，接收方发送一个应答信号，通常是一个低电平，以确认数据的接收。</li>
</ul>
</li>
<li>速率和模式：<ul>
<li>速率： I2C 支持不同的传输速率，常见的有 100 kHz、400 kHz 和 1 MHz 等。</li>
<li>模式： I2C 支持标准模式（100 kHz），快速模式（400 kHz），高速模式（1 MHz）等不同的工作模式。</li>
</ul>
</li>
<li>多主设备和重复启动：<ul>
<li>多主设备： I2C 支持多主设备共享同一总线。主设备之间通过仲裁（Arbitration）来确定哪个主设备能够继续发送。</li>
<li>重复启动： 主设备可以在一个传输结束后发送重复启动条件，而无需先发送停止条件，从而在同一次通信中与另一个从设备建立连接。</li>
</ul>
</li>
<li>I2C设备地址：<ul>
<li>7位或10位地址： I2C 设备使用 7 位或 10 位地址来识别自己。大多数设备使用 7 位地址。</li>
</ul>
</li>
</ol>
<p>I2C 协议的简洁性和灵活性使得它在连接各种设备和传感器时非常有用，尤其是在嵌入式系统中。</p>
<h2><a class="anchor" id="autotoc_md2"></a>
补充: 高阻态</h2>
<p>在嵌入式领域中，高阻态的概念同样非常重要，并涉及到数字电路设计和信号完整性的方面。以下是在嵌入式系统中高阻态的一些关键应用和概念：</p>
<ol type="1">
<li>输入端口的高阻态： 很多嵌入式系统包括微控制器或微处理器，**其输入端口通常具有高阻抗特性。这意味着当输入端口未连接到任何外部设备时，输入端口会处于高阻态状态。这有助于避免在未连接设备时引入不必要的电流，同时防止信号线上的悬空状态(floating)**。</li>
<li>悬空输入的高阻态： 在数字电路中，当一个输入端未连接时，它被称为悬空输入。在悬空输入的情况下，该输入端常常设计为高阻态，以减少对电路的干扰和功耗。</li>
<li>总线冲突的高阻态： **在多主设备共享总线的系统中，当多个主设备尝试在同一时刻传输数据时可能会发生总线冲突。为了避免冲突设备之间的干扰，某些设备在冲突时会将总线设置为高阻态，以允许其他设备继续操作**。</li>
<li>三态逻辑门： 一些数字逻辑门（如三态门）具有高阻态输出。这允许将多个门连接到同一总线上，当其中一个门处于高阻态时，其他门仍能够正常工作。</li>
<li>输入缓冲器的高阻态： 在输入缓冲器中，当输入未被有效驱动时，输入缓冲器通常进入高阻态，以避免对电路产生负面影响。</li>
</ol>
<p>在这些情况下，高阻态的概念有助于确保电路在非活动状态时不引入不必要的电流，提高系统的稳定性和可靠性。这对于嵌入式系统中对功耗、信号完整性和总线冲突等方面的考虑非常重要。</p>
<h2><a class="anchor" id="autotoc_md3"></a>
I2C物理层</h2>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270111246.png" alt="I2C物理层" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270140896.png" alt="I2C物理层" class="inline"/></p>
<p><b>I2C物理层主要特点</b></p>
<ul>
<li>I2C是支持多设备的总线, 可支持多个通讯主机和从机</li>
<li>I2C使用两条线路, 一条SDA(双向串行数据线)来表示数据, 一条SCL(串行时钟线)来同步数据, 属于同步通信</li>
<li>连接到总线的设备分配独立地址(7位或10位)</li>
<li>总线接上拉电阻到电源(一般4.7KΩ, 具体看手册)<ol type="1">
<li>当设备空闲时输出高阻态*防止短路总线上的其他接地设备*</li>
<li>当所有设备都空闲时全部输出高阻态, 可通过上拉电阻把总线拉到高电平</li>
<li>输出高阻态的特性需要GPIO的开漏输出</li>
</ol>
</li>
<li>多设备占用总线会仲裁</li>
<li>具有三种传输速度模式, <b>实际开发中可使用低于最高速的速度, 协调总线设备速度一致即可</b></li>
<li>I2C可接入的设备数量受到最大电容负载的限制, 一般为400pF, <em>也就是说总线上的设备数量越多, 传输速度越慢</em></li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
I2C协议层</h2>
<p>I2C协议定义了**通讯的起始和停止信号, 数据有效性, 响应, 仲裁, 时钟同步和地址广播等环节**</p>
<p><b>I2C基本读写过程</b></p>
<p><b>主机写数据到从机</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270157626.png" alt="I2C基本读写过程" class="inline"/></p>
<ol type="1">
<li>S: 主机传输开始信号</li>
<li>SLAVE ADDRESS: 主机传输需要通信的从机地址</li>
<li>R/!W: 主机传输读或写信号, <em>若为1(写)则主机向从机发送数据, 若为0(读)则从机向主机发送数据</em></li>
<li>A: 从机传输响应</li>
<li>DATA: 主机传输数据段</li>
<li>A: 从机响应</li>
<li>DATA: 主机继续发送数据段</li>
<li>A/!A: 从机响应是否继续接收</li>
<li>P: 若从机响应不继续接收, 则主机传输停止位</li>
</ol>
<p><b>主机由从机读数据</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270207508.png" alt="I2C基本读写过程" class="inline"/></p>
<ol type="1">
<li>S: 主机传输开始信号</li>
<li>SLAVE ADDRESS: 主机传输需要通信的从机地址</li>
<li>R/!W: 主机传输读或写信号, <em>若为1(写)则主机向从机发送数据, 若为0(读)则从机向主机发送数据</em></li>
<li>A: 从机传输响应</li>
<li>DATA: 从机传输数据段</li>
<li>A: 主机响应</li>
<li>DATA: 从机继续发送数据段</li>
<li>A/!A: 主机响应是否继续接收</li>
<li>P: 若主机响应不继续接收, 则主机传输停止位</li>
</ol>
<p>注意:</p>
<ul>
<li>S: 开始信号只能由主机产生</li>
<li>SLAVE ADDRESS: 进行通信的从机地址只能由主机产生</li>
<li>R/!W: 读/写信号只能由主机产生</li>
<li>P: 停止信号只能由主机产生</li>
<li>DATA 和 A: 数据段和响应段由主机和从机交替产生, 具体由主机和从机的读写决定</li>
</ul>
<p><b>通信复合格式</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270209992.png" alt="通信复合格式" class="inline"/></p>
<p>常用的复合通信的方法, <b>即先写入外设地址后将外设的寄存器地址返回进行读取</b></p>
<ul>
<li>S: 主机传输开始信号</li>
<li>SLAVE ADDRESS: 进行通信的从机地址(一般为外设)</li>
<li>R/W!: 一般为写操作</li>
<li>DATA: 写入的外设地址</li>
<li>A/A!: 从机响应</li>
<li>Sr: 主机传输开始信号</li>
<li>SLAVE ADDRESS: 进行通信的从机地址(一般为同一个外设)</li>
<li>R/W!: 一般为读操作</li>
<li>DATA: 读取外设的寄存器的具体地址</li>
<li>A/A!: 逐个字节进行读取外设每个寄存器的地址并做出响应</li>
<li>P: 全部读取完毕后主机传输停止信号</li>
</ul>
<p><b>通讯的起始和停止信号</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270225648.png" alt="通讯的起始和停止信号" class="inline"/></p>
<ul>
<li>起始信号: <b>SCL高电平, SDA由高电平向低电平转换</b></li>
<li>停止信号: <b>SCL高电平, SDA由低电平向高电平转换</b></li>
</ul>
<p><b>数据的有效性</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270237788.png" alt="数据有效性" class="inline"/></p>
<ul>
<li>SDA: 负责传输数据</li>
<li>SCL: 高电平时采集SDA上1bit数据, 低电平时SDA进行电平转换</li>
</ul>
<p><b>地址及数据方向</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270243764.png" alt="地址及数据方向" class="inline"/></p>
<p><b>I2C采用高位先行, 由高位到低位进行传输</b></p>
<p><b>一般使用7位表示I2C上的设备地址, 设备地址加上其后的读写位可以凑成8位即1字节方便传输</b></p>
<p>例如, 某设备在I2C上的设备地址为7位的0x78(0b01111000), 可加入读写位凑到八位</p>
<ul>
<li>8位设备的读地址位为0xF1(0b11110001)</li>
<li>8位设备的写地址位为0xF0(0b11110000)</li>
</ul>
<p><b>响应</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270254565.png" alt="响应" class="inline"/></p>
<ol type="1">
<li>1-8个时钟信号中: 数据发送端控制SDA传输7位设备地址和1位读写信号</li>
<li>在第9个时钟信号时: 数据接收端获得SDA控制权, 发送应答信号(低电平表示应答)</li>
</ol>
<h2><a class="anchor" id="autotoc_md5"></a>
STM32的I2C特性及架构</h2>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270305500.png" alt="STM32的I2C特性及架构" class="inline"/></p>
<ul>
<li>软件模拟协议: 较为繁琐</li>
<li>硬件模拟协议: 较为方便, 减轻CPU负担</li>
</ul>
<p><em>STM32硬件的I2C逻辑可能会有问题</em></p>
<p><b>STM32的I2C架构分析</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270315440.png" alt="STM32的I2C架构分析" class="inline"/></p>
<p><b>I2C的通讯引脚</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270346561.png" alt="I2C的通讯引脚" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270316720.png" alt="I2C的通讯引脚" class="inline"/></p>
<p><em>勘误: I2C1_SCL默认映射到PB5, I2C1_SDA默认映射到PB7, 图片中有误</em></p>
<p><b>STM32兼容smbus协议</b></p>
<p><b>时钟控制逻辑</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270347794.png" alt="时钟控制逻辑" class="inline"/> <img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270325594.png" alt="时钟控制逻辑" class="inline"/></p>
<p><em>Tpck1: 指的是APB1时钟周期(1/36MHz)</em></p>
<p><b>计算时钟频率的方法</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270333989.png" alt="计算时钟频率的方法" class="inline"/></p>
<p><b>实际就是解未知数CCR的一元一次方程</b></p>
<p><b>数据控制逻辑</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270347332.png" alt="数据控制逻辑" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270337311.png" alt="数据控制逻辑" class="inline"/></p>
<ol type="1">
<li>将8位数据写入数据寄存器(DR)</li>
<li>数据寄存器里面的数据会被发送到数据移位寄存器</li>
</ol>
<p><b>整体控制逻辑</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270348369.png" alt="整体控制逻辑" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270355991.png" alt="整体控制逻辑" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md6"></a>
STM32硬件I2C的通讯过程</h2>
<p><b>STM32作为主发送器的通讯过程</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270357886.png" alt="STM32作为主发送器的通讯过程" class="inline"/></p>
<p><em>勘误: EV8_2: TxE=1, BTF=1, 请求设置停止位. TxE和BTF位由硬件在产生停止条件时清除</em></p>
<ul>
<li>EV5: 在正常产生S起始信号后会产生EV5事件(I2C_SRx:SB[0]置1表示起始条件已发送)</li>
<li>EV6: 在正常发送SLAVE ADDRESS和R/!W位后会产生EV6事件(I2C_SRx:ADDR[1]置1表示地址发送结束)</li>
<li>EV8: 在正常数据发送完毕后会产生EV8事件(I2C_SRx:TxE[7]置1表示数据寄存器空)</li>
<li>EV8_2: 在从机发送结束应答后会产生EV8_2事件(I2C_SRx:TxE[7]置1表示数据寄存器空, I2C_SRx:BTF[2]置1表示字节发送结束, I2C_CRx:STOP[9]置1表示在当前字节传输或在当前起始条件发出后产生停止条件, 产生停止条件后由硬件清除TxE和BTF位)</li>
</ul>
<p><b>STM32作为主接收器的通讯过程</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401270423471.png" alt="STM32作为主接收器的通讯过程" class="inline"/></p>
<p><em>勘误: EV7_1: RxNE=1, 读DR寄存器清除该事件. 设置ACK=0和STOP请求</em></p>
<ul>
<li>EV5: 在正常产生S起始信号后会产生EV5事件(I2C_SRx:SB[0]置1表示起始条件已发送)</li>
<li>EV6: 在正常发送SLAVE ADDRESS和R/!W位后会产生EV6事件(I2C_SRx:ADDR[1]置1表示地址发送结束)</li>
<li>EV7: 在正常数据发送完毕后会产生EV7事件(I2C_SRx:RxNE[6]置1表示数据寄存器(接收时)非空)</li>
<li>EV7_1: 在主机发送结束应答后会产生EV7_1事件(I2C_SRx:RxNE[6]置1表示数据寄存器(接收时)非空, I2C_CRx:ACK[10]置0表示设置为无应答返回, I2C_CRx:STOP[9]置1表示在当前字节传输或释放SCL和SDA线)</li>
</ul>
<p><b>标志位的清除方法</b></p>
<p>每个状态标志位的清除方法各不相同, 使用库函数的方法可以较方便的清除寄存器的标志位</p>
<h2><a class="anchor" id="autotoc_md7"></a>
I2C初始化结构体</h2>
<p>在stm32f10x_i2c.h中定义I2C初始化结构体</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 设置时钟频率</span></div>
<div class="line"><span class="comment">   * 设置I2C的传输速率, 函数根据该值经过运算后写入I2C_CCR寄存器</span></div>
<div class="line"><span class="comment">   * 不得高于400kHz, 即400 000</span></div>
<div class="line"><span class="comment">   * 由于I2C_CCR寄存器不能写入浮点数, 可能会导致实际速率小于设定的传输速率参数</span></div>
<div class="line"><span class="comment">   * 使得通讯稍慢, 但是并不会对I2C的通讯造成其他影响</span></div>
<div class="line"><span class="comment">   *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint32_t I2C_ClockSpeed;          </div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 设置I2C的模式</span></div>
<div class="line"><span class="comment">   * I2C_Mode_I2C: 标准I2C模式</span></div>
<div class="line"><span class="comment">   * I2C_Mode_SMBusDevice: SMBus设备模式</span></div>
<div class="line"><span class="comment">   * I2C_Mode_SMBusHost: SMBus主机模式</span></div>
<div class="line"><span class="comment">   *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint16_t I2C_Mode;                </div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 设置I2C的SCL时钟的占空比</span></div>
<div class="line"><span class="comment">   * I2C_DutyCycle_16_9: Tlow/Thigh = 16:9</span></div>
<div class="line"><span class="comment">   * I2C_DutyCycle_2: Tlow/Thigh = 2:1</span></div>
<div class="line"><span class="comment">   * 这两个选项差别不大, 开发中一般不会进行严格区分</span></div>
<div class="line"><span class="comment">   *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint16_t I2C_DutyCycle;           </div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 配置STM32的I2C设备自己的地址</span></div>
<div class="line"><span class="comment">   * 此参数可以是 7 位或 10 位地址</span></div>
<div class="line"><span class="comment">   * 第二个地址可以通过函数I2C_OwnAddress2Config进行配置, 只能是7位地址</span></div>
<div class="line"><span class="comment">   *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint16_t I2C_OwnAddress1;         </div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 配置I2C应答是否使能</span></div>
<div class="line"><span class="comment">   * I2C_Ack_Enable: 允许应答使能</span></div>
<div class="line"><span class="comment">   * I2C_Ack_Disable: 禁止应答使能</span></div>
<div class="line"><span class="comment">   * 一般配置为允许应答使能, 改为禁止应答使能往往会导致通讯错误</span></div>
<div class="line"><span class="comment">   *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint16_t I2C_Ack;                 </div>
<div class="line">  <span class="comment">/*---------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">   * 配置I2C的寻址长度</span></div>
<div class="line"><span class="comment">   * I2C_AcknowledgedAddress_7bit: 7位地址</span></div>
<div class="line"><span class="comment">   * I2C_AcknowledgedAddress_10bit: 10位地址</span></div>
<div class="line"><span class="comment">   * 需要根据连接到I2C总线上的设备进行选择, 确保地址长度一致, 才能进行通信</span></div>
<div class="line"><span class="comment">   * 只有I2C_OwnAddress1才能配置10位地址, I2C_OwnAddress2只支持7位地址 *-------------------------------------------------------------------------------*/</span></div>
<div class="line">  uint16_t I2C_AcknowledgedAddress; </div>
<div class="line">}<a class="code hl_struct" href="struct_i2_c___init_type_def.html">I2C_InitTypeDef</a>;</div>
<div class="ttc" id="astruct_i2_c___init_type_def_html"><div class="ttname"><a href="struct_i2_c___init_type_def.html">I2C_InitTypeDef</a></div><div class="ttdoc">I2C Init structure definition</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:51</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
I2C库函数</h2>
<p>I2C_GenerateSTART函数, 用于产生起始条件</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271607885.png" alt="I2C库函数" class="inline"/></p>
<p>I2C_GetFlagStatus函数, 用于获取状态位</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271610721.png" alt="I2C库函数" class="inline"/></p>
<p><b>I2C_FLAG参数列表对应I2C_SRx状态寄存器的各个位, 可通过查询手册查看其含义</b></p>
<p>返回值说明</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271612900.png" alt="返回值说明" class="inline"/></p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a> = 0, <a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffab44c8101cc294c074709ec1b14211792">SET</a> = !<a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a>} <a class="code hl_enumeration" href="group___exported__types.html#ga89136caac2e14c55151f527ac02daaff">FlagStatus</a>, <a class="code hl_typedef" href="group___exported__types.html#ga39d4411201fb731279ad5a409b2b80d7">ITStatus</a>;</div>
<div class="ttc" id="agroup___exported__types_html_ga39d4411201fb731279ad5a409b2b80d7"><div class="ttname"><a href="group___exported__types.html#ga39d4411201fb731279ad5a409b2b80d7">ITStatus</a></div><div class="ttdeci">enum FlagStatus ITStatus</div></div>
<div class="ttc" id="agroup___exported__types_html_ga89136caac2e14c55151f527ac02daaff"><div class="ttname"><a href="group___exported__types.html#ga89136caac2e14c55151f527ac02daaff">FlagStatus</a></div><div class="ttdeci">FlagStatus</div><div class="ttdef"><b>Definition</b> stm32f10x.h:519</div></div>
<div class="ttc" id="agroup___exported__types_html_gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05"><div class="ttname"><a href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a></div><div class="ttdeci">@ RESET</div><div class="ttdef"><b>Definition</b> stm32f10x.h:519</div></div>
<div class="ttc" id="agroup___exported__types_html_gga89136caac2e14c55151f527ac02daaffab44c8101cc294c074709ec1b14211792"><div class="ttname"><a href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffab44c8101cc294c074709ec1b14211792">SET</a></div><div class="ttdeci">@ SET</div><div class="ttdef"><b>Definition</b> stm32f10x.h:519</div></div>
</div><!-- fragment --><ul>
<li>RESET: 0, 返回RESET表示该状态位为0</li>
<li>SET: 1, 返回SET表示该状态位为1</li>
</ul>
<p>I2C_Send7bitAddress函数, 用于发送7位地址</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271616560.png" alt="I2C库函数" class="inline"/></p>
<p><em>参数Address为八位读/写地址, 通过I2C_Direction实际配置读写方向, 最终方向以I2C_Direction配置为准, 参数Address的读写位失效</em></p>
<p>I2C_SendDate函数, 通过I2Cx外设发送数据字节</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271618557.png" alt="I2C库函数" class="inline"/></p>
<p>I2C_ReceiveData函数, 返回 I2Cx 外设最近接收的数据</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271622473.png" alt="I2C库函数" class="inline"/></p>
<p>AcknowledgeConfig函数, 使能或禁用I2C的应答</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271623317.png" alt="I2C库函数" class="inline"/></p>
<p>I2C_Cmd函数, 使能或禁用I2Cx外设</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271625131.png" alt="I2C库函数" class="inline"/></p>
<p>I2C_CheckEvent函数, I2C状态监测函数</p>
<p><b>监测的事件发生则返回SUCCESS</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280036252.png" alt="I2C库函数" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280037103.png" alt="" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280037758.png" alt="" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280038783.png" alt="" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280038105.png" alt="" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md9"></a>
EEPROM硬件结构</h2>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271630443.png" alt="EEPROM" class="inline"/></p>
<p>引脚说明</p>
<ul>
<li>VCC: 电源引脚, 接3V3</li>
<li>GND: 地引脚, 接地</li>
<li>SCL: 时钟线, 经2.2K上拉电阻接3V3, 接PB6引脚(默认映射I2C1_SCL)</li>
<li>SDA: 数据线, 经2,2K上拉电阻接3V3, 接PB7引脚(默认映射I2C1_SDA)</li>
<li>HOLD: WP引脚, 接地, 不启用写保护(即可向AT24C02写数据)</li>
<li>A0-A2: 地址引脚, 接地, A0:A2为000, 如需拓展EEPROM则可通过配置A0-A2的地址引脚来进行区分(如: 配置A0:A2为001, 则可对两EEPROM进行区分)</li>
</ul>
<h2><a class="anchor" id="autotoc_md10"></a>
AT24C02介绍</h2>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271642465.png" alt="AT24C02" class="inline"/></p>
<p>AT24C02可存储256字节数据</p>
<p>引脚说明</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271648925.png" alt="AT24C02" class="inline"/></p>
<ul>
<li>A0-A2: AT24C02用来区分不同AT24C0x芯片的设备地址</li>
<li>SDA: 数据线</li>
<li>SCL: 时钟线</li>
<li>WP: 写保护, 置1启用写保护</li>
<li>NC: 不连接</li>
</ul>
<p>设备地址</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271702961.png" alt="设备地址" class="inline"/></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271702718.png" alt="设备地址" class="inline"/></p>
<p><b>AT24C02有256字节, 即属于2K(256*8)</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271701248.png" alt="设备地址" class="inline"/></p>
<p>根据原理图, 将A2-A0均接地, 则A2 = A1 = A0 = 0</p>
<p><b>AT24C02的地址为0b1010000R/W, Bit0为R/!W位</b></p>
<ul>
<li>AT24C02在A2:A1[000]情况下读地址: 0b10100001(0xA1)</li>
<li>AT24C02在A2:A1[000]情况下写地址: 0b10100000(0xA0)</li>
</ul>
<p>AT24C02的Byte Write(以字节方式写数据)操作</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271719435.png" alt="Byte Write" class="inline"/></p>
<p><em>第一个传输的数据段(DATA)为WORD ADDRESS(需要写入的字节所在的地址), 第二次传输数据段(DATA)才为真正需要写入的内容</em></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271723653.png" alt="Byte Write" class="inline"/></p>
<div class="fragment"><div class="line">翻译: Byte Write的工作流程</div>
<div class="line"> </div>
<div class="line">1. 在发送完SLAVE ADDRESS和W/!R后, 需要发送一个字节的数据地址(WORD ADDRESS)(即需要写入的字节所在的地址)</div>
<div class="line">2. 收到地址(WORD ADDRESS)后, EEPROM会响应ACK, 然后接收一个字节的数据(DATA)(真正要写入的内容)</div>
<div class="line">3. 接收到数据(DATA)后, EEPROM响应ACK, 单片机必须发送STOP信号, 不能继续传输第二段数据(给EEPROM预留写入时间)</div>
<div class="line">4. 接收到停止信号后, EEPROM在tWR的周期时间内进行向内部写入数据</div>
<div class="line">5. 在此写入周期中, 所有输入被禁用, EEPROM不进行响应</div>
</div><!-- fragment --><p>AT24C02的Page Write(以页方式写数据)操作, 又称突发写入(即仅发送一个地址可写入多个数据)</p>
<p><em>Page Write解决了Byte Write不能连续写入的缺陷</em></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271734727.png" alt="Page Write" class="inline"/></p>
<ul>
<li>WORD ADDRESS(n): 数据的起始地址</li>
<li>DATA(n): 写入到WORD ADDRESS(n)中</li>
<li>DATA(n+1): 写入到WORD ADDRESS(n+1)中</li>
<li>DATA(n+x): 写入到WORD ADDRESS(n+x)中</li>
</ul>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271741445.png" alt="Page Write" class="inline"/></p>
<div class="fragment"><div class="line">翻译: Page Write工作流程</div>
<div class="line"> </div>
<div class="line">1. AT24C02能以8字节进行Page Write</div>
<div class="line">2. 与Byte Write类似, 第一个字节是数据地址(WORD ADDRESS)(即需要写入的字节所在的地址), 在接受到第二个字节(DATA)后不会要求单片机发送STOP信号</div>
<div class="line">3. 相反, EEPROM在接收到第一个DATA(真正要写入的数据)后, 对于AT24C02来说, 能再最多传输7个DATA</div>
<div class="line">4. EEPROM每接收到一个数据位都会响应ACK, 单片机必须发送停止信号来结束Page Writting</div>
<div class="line">5. 收到每个DATA后, 对于AT24C02来说, 数据地址(WORD ADDRESS)的低三位会递增(低三位的取值情况为2^3 = 8, 即8字节)</div>
<div class="line">6. 高位地址不会递增, 从而保证原来的初始数据地址不发生改变(确保低三位正确递增)</div>
<div class="line">7. 当递增的地址到达Page的界限后, 剩下的8位数据会覆盖Page的开头</div>
<div class="line">8. 如果向EEPROM传输的DATA超过8个字节(对于AT24C02), 则数据会从头覆盖</div>
</div><!-- fragment --><p>AT24C02的ACKNOWLEDGE POLLING(确认轮询)</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280423663.png" alt="ACKNOWLEDGE POLLING" class="inline"/></p>
<div class="fragment"><div class="line">一旦内部定时写周期开始并且EEPROM输入被禁用，可以启动确认轮询。</div>
<div class="line">这涉及发送一个启动条件，后跟设备地址。读/写位是代表所需的操作。</div>
<div class="line">仅当内部写周期完成时EEPROM 会响应“0”，允许继续读取或写入序列</div>
</div><!-- fragment --><p><em>需要在向AT24C02写入数据操作后, 进行确认询问, 主机需要发送启动条件, 设备地址, 读写位, 如果AT24C02准备完毕会响应0才能继续进行才做</em></p>
<p>以I2C1为例, 软件编程实现如下</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成, SB=1(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga15c95d0ed124f029621a2061b1677ee7">I2C_GetFlagStatus</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c__flags__definition.html#gae009ab84be03fcc438625b1c39376ad4">I2C_FLAG_SB</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    } <span class="keywordflow">while</span> (<a class="code hl_function" href="group___i2_c___exported___functions.html#ga15c95d0ed124f029621a2061b1677ee7">I2C_GetFlagStatus</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c__flags__definition.html#ga5472d1196e934e0cc471aba8f66af416">I2C_FLAG_ADDR</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a>); </div>
<div class="line">    <span class="comment">/* 循环监测EV6事件(ADDR=1)(接收)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="comment">/* 结束询问 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_gaf5d3ddab1426e9d24aa6d7228014a9c3"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a></div><div class="ttdeci">void EEPROM_ACK_Polling(void)</div><div class="ttdoc">ACKNOWLEDGE POLLING 对EEPROM进行确认轮询 一旦内部定时写周期开始并且EEPROM输入被禁用，可以启动确认轮询。 这涉及发送一个启动条件，后跟设备地址。 读/写位是代表所需的操作...</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:328</div></div>
<div class="ttc" id="agroup___exported__types_html_ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf"><div class="ttname"><a href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a></div><div class="ttdeci">@ ENABLE</div><div class="ttdef"><b>Definition</b> stm32f10x.h:521</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga0cd00a4152e739294a3ba0384ad1d110"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a></div><div class="ttdeci">#define EEPROM_I2C</div><div class="ttdoc">I2C的宏定义</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:30</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_gaf1f21d11fb28ed3ee6d6fb2a281d3b48"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a></div><div class="ttdeci">#define EEPROM_I2C_WRITE_ADDRESS</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:35</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga009fc2a5b2313c36da39ece39a1156a6"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a></div><div class="ttdeci">void I2C_Send7bitAddress(I2C_TypeDef *I2Cx, uint8_t Address, uint8_t I2C_Direction)</div><div class="ttdoc">Transmits the address byte to select the slave device.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:601</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga15c95d0ed124f029621a2061b1677ee7"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga15c95d0ed124f029621a2061b1677ee7">I2C_GetFlagStatus</a></div><div class="ttdeci">FlagStatus I2C_GetFlagStatus(I2C_TypeDef *I2Cx, uint32_t I2C_FLAG)</div><div class="ttdoc">3) Flag-based state monitoring</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:1133</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga36c522b471588be9779c878222ccb20f"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a></div><div class="ttdeci">void I2C_GenerateSTART(I2C_TypeDef *I2Cx, FunctionalState NewState)</div><div class="ttdoc">Generates I2Cx communication START condition.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:394</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga5c92cb573ca0ae58cc465e5400246561"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a></div><div class="ttdeci">void I2C_GenerateSTOP(I2C_TypeDef *I2Cx, FunctionalState NewState)</div><div class="ttdoc">Generates I2Cx communication STOP condition.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:418</div></div>
<div class="ttc" id="agroup___i2_c__flags__definition_html_ga5472d1196e934e0cc471aba8f66af416"><div class="ttname"><a href="group___i2_c__flags__definition.html#ga5472d1196e934e0cc471aba8f66af416">I2C_FLAG_ADDR</a></div><div class="ttdeci">#define I2C_FLAG_ADDR</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:282</div></div>
<div class="ttc" id="agroup___i2_c__flags__definition_html_gae009ab84be03fcc438625b1c39376ad4"><div class="ttname"><a href="group___i2_c__flags__definition.html#gae009ab84be03fcc438625b1c39376ad4">I2C_FLAG_SB</a></div><div class="ttdeci">#define I2C_FLAG_SB</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:283</div></div>
<div class="ttc" id="agroup___i2_c__transfer__direction_html_ga9895ee2d7d8cc8ba4daafafa1c3ce1ac"><div class="ttname"><a href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a></div><div class="ttdeci">#define I2C_Direction_Transmitter</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:124</div></div>
</div><!-- fragment --><p>AT24C02的Current Address Read(从当前地址读数据)操作</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271810617.png" alt="Current Address Read" class="inline"/></p>
<p><em>一般不用, 因为在开发中不好确定当前地址的位置</em></p>
<p>AT24C02的Random Read(随机读数据)操作</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271813901.png" alt="Random Read" class="inline"/></p>
<ol type="1">
<li>产生起始信号, 向EEPROM发送要读取数据的数据地址(写方向)</li>
<li>再次产生起始信号, 从EEPROM中读取数据(读方向)</li>
<li>EEPROM在被写入要读取数据的数据地址后会进行确认并输出该数据内容</li>
</ol>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271821179.png" alt="Random Read" class="inline"/></p>
<div class="fragment"><div class="line">翻译: Random Read流程</div>
<div class="line"> </div>
<div class="line">1. Random Read需要&quot;dummy&quot;来写入要读取数据(DATA)的数据地址(WORD ADDRESS)</div>
<div class="line">2. 一旦DEVICE ADDRESS和WORD ADDRESS被EEPROM响应, 单片机必须生成另一个START信号</div>
<div class="line">3. 单片机发送读信号来读取当前地址(DEVICE ADDRESS)</div>
<div class="line">4. EEPROM响应DEVICE ADDRESS并串行输出数据(DATA)</div>
<div class="line">5. 单片机响应NO ACK并紧跟生成STOP信号</div>
</div><!-- fragment --><p>AT24C02的Sequential Read(顺序读数据)操作</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271838678.png" alt="Sequential Read" class="inline"/></p>
<p><b>与Page Write类似</b></p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401271841941.png" alt="Sequential Read" class="inline"/></p>
<div class="fragment"><div class="line">翻译: Sequential Read流程</div>
<div class="line"> </div>
<div class="line">1. Sequntial Read从当前地址读取或随机地址开始读取</div>
<div class="line">2. 单片机收到DATA后，会响应ACK</div>
<div class="line">3. 只要EEPROM收到ACK响应，它就会继续递增数据地址，并顺序串行输出DATA</div>
<div class="line">4. 当达到内存地址限制时，数据地址将&quot;roll over&quot;，顺序读取将继续从头开始重新读取数据</div>
<div class="line">5. 当单片机NO ACK响应并生成STOP，则终止Sequential Read</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
I2C-读写EEPROM实验</h2>
<p><b>项目地址</b> 24-I2C-EEPROM</p>
<p><b>操作流程</b></p>
<ol type="1">
<li>初始化I2C相关的GPIO</li>
<li>配置I2C外设的工作模式</li>
<li>编写I2C写入EEPROM的Byte Write函数</li>
<li>编写I2C读取EEPROM的Random Read函数</li>
<li>使用read函数和write函数进行读写校验</li>
<li>编写Page Write和Sequential Read函数进行校验</li>
</ol>
<p>在bsp_i2c.h中定义相关宏</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C I2C1 </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_CLK RCC_APB1Periph_I2C1 </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_APBxClkCmd RCC_APB1PeriphClockCmd </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_BAUDRATE 400000 </span></div>
<div class="line"><span class="preprocessor">#define STM32_I2C_OWN_ADDR 0x5F </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_WRITE_ADDRESS 0xA0 </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_READ_ADDRESS 0xA1 </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SCL_GPIO_CLK (RCC_APB2Periph_GPIOB) </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SDA_GPIO_CLK (RCC_APB2Periph_GPIOB) </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_GPIO_APBxClkCmd RCC_APB2PeriphClockCmd </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SCL_GPIO_PORT GPIOB </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SCL_GPIO_Pin GPIO_Pin_6 </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SDA_GPIO_PORT GPIOB </span></div>
<div class="line"><span class="preprocessor">#define EEPROM_I2C_SDA_GPIO_Pin GPIO_Pin_7 </span></div>
<div class="line"> </div>
</div><!-- fragment --><p>在bsp_i2c.h中进行函数声明</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gab5bae292a1facbc179f516fe0e0e4ac1">I2C_EEPROM_Config</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga33740ba02658e771d858f42c6b7b3d67">EEPROM_Byte_Writting</a>(uint8_t WordAddress, uint8_t Data);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga70eb0aa7e550f51254258a3310f6f77e">EEPROM_Page_Writting</a>(uint8_t WordAddress, uint8_t* Data, uint8_t NumByteToWrite);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga2a5fa1080d0629291afb76666167c6fd">EEPROM_Random_Read</a>(uint8_t WordAddress, uint8_t* Data);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga27a269cc6003df0b32491a8e1a02dcba">EEPROM_Sequential_Read</a>(uint8_t WordAddress, uint8_t* Data, uint8_t NumByteToRead);</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>(<span class="keywordtype">void</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_ga27a269cc6003df0b32491a8e1a02dcba"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#ga27a269cc6003df0b32491a8e1a02dcba">EEPROM_Sequential_Read</a></div><div class="ttdeci">void EEPROM_Sequential_Read(uint8_t WordAddress, uint8_t *Data, uint8_t NumByteToRead)</div><div class="ttdoc">函数实现STM32从EEPROM以Sequential Read方式读取数据</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:246</div></div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_ga2a5fa1080d0629291afb76666167c6fd"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#ga2a5fa1080d0629291afb76666167c6fd">EEPROM_Random_Read</a></div><div class="ttdeci">void EEPROM_Random_Read(uint8_t WordAddress, uint8_t *Data)</div><div class="ttdoc">函数实现STM32从EEPROM以Random Read方式读取数据</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:177</div></div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_ga33740ba02658e771d858f42c6b7b3d67"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#ga33740ba02658e771d858f42c6b7b3d67">EEPROM_Byte_Writting</a></div><div class="ttdeci">void EEPROM_Byte_Writting(uint8_t WordAddress, uint8_t Data)</div><div class="ttdoc">函数实现了STM32作为主发送器向EEPROM以Byte Writting的方式写数据</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:79</div></div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_ga70eb0aa7e550f51254258a3310f6f77e"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#ga70eb0aa7e550f51254258a3310f6f77e">EEPROM_Page_Writting</a></div><div class="ttdeci">void EEPROM_Page_Writting(uint8_t WordAddress, uint8_t *Data, uint8_t NumByteToWrite)</div><div class="ttdoc">函数实现了STM32作为主发送器向EEPROM以Page Writting的方式写数据(每次不超过8字节)</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:125</div></div>
<div class="ttc" id="agroup___e_e_p_r_o_m___i2_c___functions_html_gab5bae292a1facbc179f516fe0e0e4ac1"><div class="ttname"><a href="group___e_e_p_r_o_m___i2_c___functions.html#gab5bae292a1facbc179f516fe0e0e4ac1">I2C_EEPROM_Config</a></div><div class="ttdeci">void I2C_EEPROM_Config(void)</div><div class="ttdoc">I2C EEPROM配置函数</div><div class="ttdef"><b>Definition</b> bsp_i2c.c:23</div></div>
</div><!-- fragment --><p>在bsp_i2c.c中编写I2C_EEPROM配置函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gab5bae292a1facbc179f516fe0e0e4ac1">I2C_EEPROM_Config</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_struct" href="struct_g_p_i_o___init_type_def.html">GPIO_InitTypeDef</a> GPIO_InitStructure;</div>
<div class="line">    <a class="code hl_struct" href="struct_i2_c___init_type_def.html">I2C_InitTypeDef</a> I2C_InitStructure;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*-------------------------- 时钟配置 ------------------------------*/</span></div>
<div class="line">    <span class="comment">/* 使能I2C GPIO的时钟 */</span></div>
<div class="line">    <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga6a1d841b2bbea68128756744cfbcf6f1">EEPROM_I2C_GPIO_APBxClkCmd</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga2ee9d0de8181fd5327a7cbcaac829ffe">EEPROM_I2C_SCL_GPIO_CLK</a> | <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga70429457d36147806b3848c40b3aefb1">EEPROM_I2C_SDA_GPIO_CLK</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 使能I2C的时钟 */</span></div>
<div class="line">    <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga27dbd5ac5607a159483d52551c4c96ef">EEPROM_I2C_APBxClkCmd</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga81017ec62760419adb816f3318a3f3e1">EEPROM_I2C_CLK</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*-------------------------- I2C_SCL的GPIO配置 ------------------------------*/</span></div>
<div class="line">    <span class="comment">/* 配置引脚为I2C的SCL */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#a35fc26fc58226126c5b99478a472e5e9">GPIO_Pin</a> = <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaa6e929585f6b2cbb6610fc569e30db3f">EEPROM_I2C_SCL_GPIO_Pin</a>;</div>
<div class="line">    <span class="comment">/* 配置输出速率为50MHz */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#ac05832cacebc861a9acf5294d702c16b">GPIO_Speed</a> = <a class="code hl_enumvalue" href="group___g_p_i_o___exported___types.html#gga062ad92b67b4a1f301c161022cf3ba8ea9c47db10456202ac05134b12738ce581">GPIO_Speed_50MHz</a>;</div>
<div class="line">    <span class="comment">/* 配置模式开漏复用输出 */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#a55bd77e335c2bfeec9caa5dc922b791b">GPIO_Mode</a> = <a class="code hl_enumvalue" href="group___g_p_i_o___exported___types.html#gga1347339e1c84a196fabbb31205eec5d4ac34bf80d30de7b34444c9cbdb20695b5">GPIO_Mode_AF_OD</a>;</div>
<div class="line">    <span class="comment">/* 初始化I2C_SCL的GPIO配置 */</span> </div>
<div class="line">    <a class="code hl_function" href="group___g_p_i_o___exported___functions.html#ga71abf9404261370d03cca449b88d3a65">GPIO_Init</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gad35a7ac5e1d857504947f0701d5fd629">EEPROM_I2C_SCL_GPIO_PORT</a>, &amp;GPIO_InitStructure);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*-------------------------- I2C_SDA的GPIO配置 ------------------------------*/</span></div>
<div class="line">    <span class="comment">/* 配置引脚为I2C的SDA */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#a35fc26fc58226126c5b99478a472e5e9">GPIO_Pin</a> = <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga4217dd29d620b47c7b653d5140771ae4">EEPROM_I2C_SDA_GPIO_Pin</a>;</div>
<div class="line">    <span class="comment">/* 配置输出速率为50MHz */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#ac05832cacebc861a9acf5294d702c16b">GPIO_Speed</a> = <a class="code hl_enumvalue" href="group___g_p_i_o___exported___types.html#gga062ad92b67b4a1f301c161022cf3ba8ea9c47db10456202ac05134b12738ce581">GPIO_Speed_50MHz</a>;</div>
<div class="line">    <span class="comment">/* 配置模式开漏复用输出 */</span></div>
<div class="line">    GPIO_InitStructure.<a class="code hl_variable" href="struct_g_p_i_o___init_type_def.html#a55bd77e335c2bfeec9caa5dc922b791b">GPIO_Mode</a> = <a class="code hl_enumvalue" href="group___g_p_i_o___exported___types.html#gga1347339e1c84a196fabbb31205eec5d4ac34bf80d30de7b34444c9cbdb20695b5">GPIO_Mode_AF_OD</a>;</div>
<div class="line">    <span class="comment">/* 初始化I2C_SDA的GPIO配置 */</span> </div>
<div class="line">    <a class="code hl_function" href="group___g_p_i_o___exported___functions.html#ga71abf9404261370d03cca449b88d3a65">GPIO_Init</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gae8982a11097f17f9e05a262ecf82ee77">EEPROM_I2C_SDA_GPIO_PORT</a>, &amp;GPIO_InitStructure);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*-------------------------- I2C的工作模式配置 ------------------------------*/</span></div>
<div class="line">    <span class="comment">/* 使能响应 */</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#a7bcae26f098e897832e5e42b055f8c98">I2C_Ack</a> = <a class="code hl_define" href="group___i2_c__acknowledgement.html#ga616466f8ef5a47237cdbf7ac578ec507">I2C_Ack_Enable</a>;</div>
<div class="line">    <span class="comment">/* 使用7位地址 */</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#a300e847972f50b0d25c4f13be5d93d79">I2C_AcknowledgedAddress</a> = <a class="code hl_define" href="group___i2_c__acknowledged__address.html#ga5e5ad2148f9da14457c7b59357acee97">I2C_AcknowledgedAddress_7bit</a>;</div>
<div class="line">    <span class="comment">/* 时钟频率 400kHz*/</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#a737c289f4515ae4cb642db0412762169">I2C_ClockSpeed</a> = <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga72d5bef2f993a2af3581c0a3aebea127">EEPROM_I2C_BAUDRATE</a>;</div>
<div class="line">    <span class="comment">/* 占空比 Tlow/Thigh = 2 */</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#aff23b28652359513dfd268dee54c3279">I2C_DutyCycle</a> = <a class="code hl_define" href="group___i2_c__duty__cycle__in__fast__mode.html#gafe0af31970aceef0fa8df6a10bef35db">I2C_DutyCycle_2</a>;</div>
<div class="line">    <span class="comment">/* 模式 I2C */</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#ad5cf353c5b6968b3610b70ca593cec52">I2C_Mode</a> = <a class="code hl_define" href="group___i2_c__mode.html#ga8bc3b0555ca31b6f8423bc2ada45d1ac">I2C_Mode_I2C</a>;</div>
<div class="line">    <span class="comment">/* STM32主机地址 */</span></div>
<div class="line">    I2C_InitStructure.<a class="code hl_variable" href="struct_i2_c___init_type_def.html#a08543cb71b4b2a89ad81a2cefff12b53">I2C_OwnAddress1</a> = <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga152a87e250c874489f66136802d9710e">STM32_I2C_OWN_ADDR</a>;</div>
<div class="line">    <span class="comment">/* 初始化I2C */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#gaac29465bca70fbc91c2f922ab67bb88e">I2C_Init</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, &amp;I2C_InitStructure); </div>
<div class="line">    <span class="comment">/* 使能I2C */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7e1323c9133c2cb424dfb5b10b7d2f0b">I2C_Cmd</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___g_p_i_o___exported___functions_html_ga71abf9404261370d03cca449b88d3a65"><div class="ttname"><a href="group___g_p_i_o___exported___functions.html#ga71abf9404261370d03cca449b88d3a65">GPIO_Init</a></div><div class="ttdeci">void GPIO_Init(GPIO_TypeDef *GPIOx, GPIO_InitTypeDef *GPIO_InitStruct)</div><div class="ttdoc">Initializes the GPIOx peripheral according to the specified parameters in the GPIO_InitStruct.</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.c:173</div></div>
<div class="ttc" id="agroup___g_p_i_o___exported___types_html_gga062ad92b67b4a1f301c161022cf3ba8ea9c47db10456202ac05134b12738ce581"><div class="ttname"><a href="group___g_p_i_o___exported___types.html#gga062ad92b67b4a1f301c161022cf3ba8ea9c47db10456202ac05134b12738ce581">GPIO_Speed_50MHz</a></div><div class="ttdeci">@ GPIO_Speed_50MHz</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:62</div></div>
<div class="ttc" id="agroup___g_p_i_o___exported___types_html_gga1347339e1c84a196fabbb31205eec5d4ac34bf80d30de7b34444c9cbdb20695b5"><div class="ttname"><a href="group___g_p_i_o___exported___types.html#gga1347339e1c84a196fabbb31205eec5d4ac34bf80d30de7b34444c9cbdb20695b5">GPIO_Mode_AF_OD</a></div><div class="ttdeci">@ GPIO_Mode_AF_OD</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:78</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga152a87e250c874489f66136802d9710e"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga152a87e250c874489f66136802d9710e">STM32_I2C_OWN_ADDR</a></div><div class="ttdeci">#define STM32_I2C_OWN_ADDR</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:34</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga27dbd5ac5607a159483d52551c4c96ef"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga27dbd5ac5607a159483d52551c4c96ef">EEPROM_I2C_APBxClkCmd</a></div><div class="ttdeci">#define EEPROM_I2C_APBxClkCmd</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:32</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga2ee9d0de8181fd5327a7cbcaac829ffe"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga2ee9d0de8181fd5327a7cbcaac829ffe">EEPROM_I2C_SCL_GPIO_CLK</a></div><div class="ttdeci">#define EEPROM_I2C_SCL_GPIO_CLK</div><div class="ttdoc">I2C的GPIO引脚宏定义</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:42</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga4217dd29d620b47c7b653d5140771ae4"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga4217dd29d620b47c7b653d5140771ae4">EEPROM_I2C_SDA_GPIO_Pin</a></div><div class="ttdeci">#define EEPROM_I2C_SDA_GPIO_Pin</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:48</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga6a1d841b2bbea68128756744cfbcf6f1"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga6a1d841b2bbea68128756744cfbcf6f1">EEPROM_I2C_GPIO_APBxClkCmd</a></div><div class="ttdeci">#define EEPROM_I2C_GPIO_APBxClkCmd</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:44</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga70429457d36147806b3848c40b3aefb1"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga70429457d36147806b3848c40b3aefb1">EEPROM_I2C_SDA_GPIO_CLK</a></div><div class="ttdeci">#define EEPROM_I2C_SDA_GPIO_CLK</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:43</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga72d5bef2f993a2af3581c0a3aebea127"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga72d5bef2f993a2af3581c0a3aebea127">EEPROM_I2C_BAUDRATE</a></div><div class="ttdeci">#define EEPROM_I2C_BAUDRATE</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:33</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga81017ec62760419adb816f3318a3f3e1"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga81017ec62760419adb816f3318a3f3e1">EEPROM_I2C_CLK</a></div><div class="ttdeci">#define EEPROM_I2C_CLK</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:31</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_gaa6e929585f6b2cbb6610fc569e30db3f"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#gaa6e929585f6b2cbb6610fc569e30db3f">EEPROM_I2C_SCL_GPIO_Pin</a></div><div class="ttdeci">#define EEPROM_I2C_SCL_GPIO_Pin</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:46</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_gad35a7ac5e1d857504947f0701d5fd629"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#gad35a7ac5e1d857504947f0701d5fd629">EEPROM_I2C_SCL_GPIO_PORT</a></div><div class="ttdeci">#define EEPROM_I2C_SCL_GPIO_PORT</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:45</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_gae8982a11097f17f9e05a262ecf82ee77"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#gae8982a11097f17f9e05a262ecf82ee77">EEPROM_I2C_SDA_GPIO_PORT</a></div><div class="ttdeci">#define EEPROM_I2C_SDA_GPIO_PORT</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:47</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga7e1323c9133c2cb424dfb5b10b7d2f0b"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga7e1323c9133c2cb424dfb5b10b7d2f0b">I2C_Cmd</a></div><div class="ttdeci">void I2C_Cmd(I2C_TypeDef *I2Cx, FunctionalState NewState)</div><div class="ttdoc">Enables or disables the specified I2C peripheral.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:322</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_gaac29465bca70fbc91c2f922ab67bb88e"><div class="ttname"><a href="group___i2_c___exported___functions.html#gaac29465bca70fbc91c2f922ab67bb88e">I2C_Init</a></div><div class="ttdeci">void I2C_Init(I2C_TypeDef *I2Cx, I2C_InitTypeDef *I2C_InitStruct)</div><div class="ttdoc">Initializes the I2Cx peripheral according to the specified parameters in the I2C_InitStruct.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:191</div></div>
<div class="ttc" id="agroup___i2_c__acknowledged__address_html_ga5e5ad2148f9da14457c7b59357acee97"><div class="ttname"><a href="group___i2_c__acknowledged__address.html#ga5e5ad2148f9da14457c7b59357acee97">I2C_AcknowledgedAddress_7bit</a></div><div class="ttdeci">#define I2C_AcknowledgedAddress_7bit</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:136</div></div>
<div class="ttc" id="agroup___i2_c__acknowledgement_html_ga616466f8ef5a47237cdbf7ac578ec507"><div class="ttname"><a href="group___i2_c__acknowledgement.html#ga616466f8ef5a47237cdbf7ac578ec507">I2C_Ack_Enable</a></div><div class="ttdeci">#define I2C_Ack_Enable</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:112</div></div>
<div class="ttc" id="agroup___i2_c__duty__cycle__in__fast__mode_html_gafe0af31970aceef0fa8df6a10bef35db"><div class="ttname"><a href="group___i2_c__duty__cycle__in__fast__mode.html#gafe0af31970aceef0fa8df6a10bef35db">I2C_DutyCycle_2</a></div><div class="ttdeci">#define I2C_DutyCycle_2</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:101</div></div>
<div class="ttc" id="agroup___i2_c__mode_html_ga8bc3b0555ca31b6f8423bc2ada45d1ac"><div class="ttname"><a href="group___i2_c__mode.html#ga8bc3b0555ca31b6f8423bc2ada45d1ac">I2C_Mode_I2C</a></div><div class="ttdeci">#define I2C_Mode_I2C</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:86</div></div>
<div class="ttc" id="astruct_g_p_i_o___init_type_def_html"><div class="ttname"><a href="struct_g_p_i_o___init_type_def.html">GPIO_InitTypeDef</a></div><div class="ttdoc">GPIO Init structure definition</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:92</div></div>
<div class="ttc" id="astruct_g_p_i_o___init_type_def_html_a35fc26fc58226126c5b99478a472e5e9"><div class="ttname"><a href="struct_g_p_i_o___init_type_def.html#a35fc26fc58226126c5b99478a472e5e9">GPIO_InitTypeDef::GPIO_Pin</a></div><div class="ttdeci">uint16_t GPIO_Pin</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:93</div></div>
<div class="ttc" id="astruct_g_p_i_o___init_type_def_html_a55bd77e335c2bfeec9caa5dc922b791b"><div class="ttname"><a href="struct_g_p_i_o___init_type_def.html#a55bd77e335c2bfeec9caa5dc922b791b">GPIO_InitTypeDef::GPIO_Mode</a></div><div class="ttdeci">GPIOMode_TypeDef GPIO_Mode</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:99</div></div>
<div class="ttc" id="astruct_g_p_i_o___init_type_def_html_ac05832cacebc861a9acf5294d702c16b"><div class="ttname"><a href="struct_g_p_i_o___init_type_def.html#ac05832cacebc861a9acf5294d702c16b">GPIO_InitTypeDef::GPIO_Speed</a></div><div class="ttdeci">GPIOSpeed_TypeDef GPIO_Speed</div><div class="ttdef"><b>Definition</b> stm32f10x_gpio.h:96</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_a08543cb71b4b2a89ad81a2cefff12b53"><div class="ttname"><a href="struct_i2_c___init_type_def.html#a08543cb71b4b2a89ad81a2cefff12b53">I2C_InitTypeDef::I2C_OwnAddress1</a></div><div class="ttdeci">uint16_t I2C_OwnAddress1</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:61</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_a300e847972f50b0d25c4f13be5d93d79"><div class="ttname"><a href="struct_i2_c___init_type_def.html#a300e847972f50b0d25c4f13be5d93d79">I2C_InitTypeDef::I2C_AcknowledgedAddress</a></div><div class="ttdeci">uint16_t I2C_AcknowledgedAddress</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:67</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_a737c289f4515ae4cb642db0412762169"><div class="ttname"><a href="struct_i2_c___init_type_def.html#a737c289f4515ae4cb642db0412762169">I2C_InitTypeDef::I2C_ClockSpeed</a></div><div class="ttdeci">uint32_t I2C_ClockSpeed</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:52</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_a7bcae26f098e897832e5e42b055f8c98"><div class="ttname"><a href="struct_i2_c___init_type_def.html#a7bcae26f098e897832e5e42b055f8c98">I2C_InitTypeDef::I2C_Ack</a></div><div class="ttdeci">uint16_t I2C_Ack</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:64</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_ad5cf353c5b6968b3610b70ca593cec52"><div class="ttname"><a href="struct_i2_c___init_type_def.html#ad5cf353c5b6968b3610b70ca593cec52">I2C_InitTypeDef::I2C_Mode</a></div><div class="ttdeci">uint16_t I2C_Mode</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:55</div></div>
<div class="ttc" id="astruct_i2_c___init_type_def_html_aff23b28652359513dfd268dee54c3279"><div class="ttname"><a href="struct_i2_c___init_type_def.html#aff23b28652359513dfd268dee54c3279">I2C_InitTypeDef::I2C_DutyCycle</a></div><div class="ttdeci">uint16_t I2C_DutyCycle</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:58</div></div>
</div><!-- fragment --><p>在bsp_i2c.c中编写Byte Writting方式的函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga33740ba02658e771d858f42c6b7b3d67">EEPROM_Byte_Writting</a>(uint8_t WordAddress, uint8_t Data)</div>
<div class="line">{</div>
<div class="line"><span class="comment">/*---------------- STM32发送WordAddress ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(发送)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga2361a6e60b7dc86fb682dd06fbd3edb7">I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* 不检测EV8事件(I2C_SRx:TxE[7] = 1, 数据寄存器空很正常, 不进行检测) */</span></div>
<div class="line">    <span class="comment">/* STM32向EEPROM发送WordAddress */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, WordAddress);</div>
<div class="line">    <span class="comment">/* 等待EV8事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga037ac1e67e44ee085acac6f034bd73b2">I2C_EVENT_MASTER_BYTE_TRANSMITTING</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">/*---------------- STM32发送Data ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32向EEPROM发送Data */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, Data);</div>
<div class="line">    <span class="comment">/* 等待EV8_2事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga8fe3b96b54e3c38e1de5d48536039c8f">I2C_EVENT_MASTER_BYTE_TRANSMITTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32产生STOP信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* STM32使能ACK信号, 恢复到默认状态 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___exported__types_html_gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90"><div class="ttname"><a href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a></div><div class="ttdeci">@ ERROR</div><div class="ttdef"><b>Definition</b> stm32f10x.h:524</div></div>
<div class="ttc" id="agroup___i2_c___events_html_ga037ac1e67e44ee085acac6f034bd73b2"><div class="ttname"><a href="group___i2_c___events.html#ga037ac1e67e44ee085acac6f034bd73b2">I2C_EVENT_MASTER_BYTE_TRANSMITTING</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_BYTE_TRANSMITTING</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:387</div></div>
<div class="ttc" id="agroup___i2_c___events_html_ga2361a6e60b7dc86fb682dd06fbd3edb7"><div class="ttname"><a href="group___i2_c___events.html#ga2361a6e60b7dc86fb682dd06fbd3edb7">I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</div><div class="ttdoc">Address Acknowledge</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:347</div></div>
<div class="ttc" id="agroup___i2_c___events_html_ga8fe3b96b54e3c38e1de5d48536039c8f"><div class="ttname"><a href="group___i2_c___events.html#ga8fe3b96b54e3c38e1de5d48536039c8f">I2C_EVENT_MASTER_BYTE_TRANSMITTED</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_BYTE_TRANSMITTED</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:389</div></div>
<div class="ttc" id="agroup___i2_c___events_html_gaeef8c22ac035122b06e31b360ac7aeb3"><div class="ttname"><a href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_MODE_SELECT</div><div class="ttdoc">Communication start</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:319</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga2d5701342f9d4c1f09bf9d3cdcacc326"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a></div><div class="ttdeci">ErrorStatus I2C_CheckEvent(I2C_TypeDef *I2Cx, uint32_t I2C_EVENT)</div><div class="ttdoc">I2C State Monitoring Functions</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:1030</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga7bb44e894d68a7991f564c43fb187486"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a></div><div class="ttdeci">void I2C_AcknowledgeConfig(I2C_TypeDef *I2Cx, FunctionalState NewState)</div><div class="ttdoc">Enables or disables the specified I2C acknowledge feature.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:442</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_ga7bd9e70b8eafde0dd5eb42b0d95fe1a9"><div class="ttname"><a href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a></div><div class="ttdeci">void I2C_SendData(I2C_TypeDef *I2Cx, uint8_t Data)</div><div class="ttdoc">Sends a data byte through the I2Cx peripheral.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:570</div></div>
</div><!-- fragment --><p>在bsp_i2c.c中编写Page Writting方式的函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga70eb0aa7e550f51254258a3310f6f77e">EEPROM_Page_Writting</a>(uint8_t WordAddress, uint8_t* Data, uint8_t NumByteToWrite)</div>
<div class="line">{</div>
<div class="line"><span class="comment">/*---------------- STM32发送WordAddress ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(发送)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga2361a6e60b7dc86fb682dd06fbd3edb7">I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* 不检测EV8事件(I2C_SRx:TxE[7] = 1, 数据寄存器空很正常, 不进行检测) */</span></div>
<div class="line">    <span class="comment">/* STM32向EEPROM发送WordAddress */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, WordAddress);</div>
<div class="line">    <span class="comment">/* 等待EV8事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga037ac1e67e44ee085acac6f034bd73b2">I2C_EVENT_MASTER_BYTE_TRANSMITTING</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">/*---------------- STM32发送Data ----------------*/</span></div>
<div class="line">    <span class="comment">/* 循环写入数据 */</span></div>
<div class="line">    <span class="keywordflow">while</span>(NumByteToWrite)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* STM32向EEPROM发送Data */</span></div>
<div class="line">        <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, *Data);</div>
<div class="line">        <span class="comment">/* 数据指针自增 */</span></div>
<div class="line">        Data++;</div>
<div class="line">        <span class="comment">/* 等待EV8_2事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">        <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga8fe3b96b54e3c38e1de5d48536039c8f">I2C_EVENT_MASTER_BYTE_TRANSMITTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">        {</div>
<div class="line">        ;</div>
<div class="line">        }</div>
<div class="line">        NumByteToWrite--;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32产生STOP信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* STM32使能ACK信号, 恢复到默认状态 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>在bsp_i2c.c中编写Random Read方式的函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga2a5fa1080d0629291afb76666167c6fd">EEPROM_Random_Read</a>(uint8_t WordAddress, uint8_t* Data)</div>
<div class="line">{</div>
<div class="line"><span class="comment">/*---------------- STM32发送WordAddress ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(发送)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga2361a6e60b7dc86fb682dd06fbd3edb7">I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* 不检测EV8事件(I2C_SRx:TxE[7] = 1, 数据寄存器空很正常, 不进行检测) */</span></div>
<div class="line">    <span class="comment">/* STM32向EEPROM发送WordAddress */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, WordAddress);</div>
<div class="line">    <span class="comment">/* 等待EV8事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga037ac1e67e44ee085acac6f034bd73b2">I2C_EVENT_MASTER_BYTE_TRANSMITTING</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line"><span class="comment">/*---------------- STM32接收Data ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32另外产生一个START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的读地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga61da15dd7fd993a66da6d35f16182280">EEPROM_I2C_READ_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#gafe3b9b98552980ca56c8e21a90040fa0">I2C_Direction_Receiver</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(接收)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gabfde82864432ddb87b6462234d542e60">I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">    * 注意: </span></div>
<div class="line"><span class="comment">    * 该部分为STM32接收来自EEPROM的数据</span></div>
<div class="line"><span class="comment">    * 接收数据部分, 硬件会自动进行接收, 软件编程时无需操作</span></div>
<div class="line"><span class="comment">    * I2C_ReceiveData函数只是返回I2Cx上最近接收到的数据</span></div>
<div class="line"><span class="comment">    * 而不是进行数据接收</span></div>
<div class="line"><span class="comment">    *------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* 监测到EV7事件发生, 说明接收到了新数据 */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga6bcf2ae49961e07e27cf9fdf334719e3">I2C_EVENT_MASTER_BYTE_RECEIVED</a> ) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* 将接收到的数据赋值给Data变量 */</span></div>
<div class="line">    *Data = <a class="code hl_function" href="group___i2_c___exported___functions.html#gaeaaa4b6f77f50eb57465148c55d27fb2">I2C_ReceiveData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>);</div>
<div class="line">    <span class="comment">/* STM32产生NO ACK响应 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a>);</div>
<div class="line">    <span class="comment">/* STM32产生STOP信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup___exported__types_html_ggac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d"><div class="ttname"><a href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a></div><div class="ttdeci">@ DISABLE</div><div class="ttdef"><b>Definition</b> stm32f10x.h:521</div></div>
<div class="ttc" id="agroup___i2_c___e_e_p_r_o_m___define_html_ga61da15dd7fd993a66da6d35f16182280"><div class="ttname"><a href="group___i2_c___e_e_p_r_o_m___define.html#ga61da15dd7fd993a66da6d35f16182280">EEPROM_I2C_READ_ADDRESS</a></div><div class="ttdeci">#define EEPROM_I2C_READ_ADDRESS</div><div class="ttdef"><b>Definition</b> bsp_i2c.h:36</div></div>
<div class="ttc" id="agroup___i2_c___events_html_ga6bcf2ae49961e07e27cf9fdf334719e3"><div class="ttname"><a href="group___i2_c___events.html#ga6bcf2ae49961e07e27cf9fdf334719e3">I2C_EVENT_MASTER_BYTE_RECEIVED</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_BYTE_RECEIVED</div><div class="ttdoc">Communication events</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:383</div></div>
<div class="ttc" id="agroup___i2_c___events_html_gabfde82864432ddb87b6462234d542e60"><div class="ttname"><a href="group___i2_c___events.html#gabfde82864432ddb87b6462234d542e60">I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED</a></div><div class="ttdeci">#define I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:348</div></div>
<div class="ttc" id="agroup___i2_c___exported___functions_html_gaeaaa4b6f77f50eb57465148c55d27fb2"><div class="ttname"><a href="group___i2_c___exported___functions.html#gaeaaa4b6f77f50eb57465148c55d27fb2">I2C_ReceiveData</a></div><div class="ttdeci">uint8_t I2C_ReceiveData(I2C_TypeDef *I2Cx)</div><div class="ttdoc">Returns the most recent received data by the I2Cx peripheral.</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.c:583</div></div>
<div class="ttc" id="agroup___i2_c__transfer__direction_html_gafe3b9b98552980ca56c8e21a90040fa0"><div class="ttname"><a href="group___i2_c__transfer__direction.html#gafe3b9b98552980ca56c8e21a90040fa0">I2C_Direction_Receiver</a></div><div class="ttdeci">#define I2C_Direction_Receiver</div><div class="ttdef"><b>Definition</b> stm32f10x_i2c.h:125</div></div>
</div><!-- fragment --><p>在bsp_i2c.c中编写Sequential Read方式的函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga27a269cc6003df0b32491a8e1a02dcba">EEPROM_Sequential_Read</a>(uint8_t WordAddress, uint8_t* Data, uint8_t NumByteToRead)</div>
<div class="line">{</div>
<div class="line"><span class="comment">/*---------------- STM32发送WordAddress ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(发送)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga2361a6e60b7dc86fb682dd06fbd3edb7">I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">      ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* 不检测EV8事件(I2C_SRx:TxE[7] = 1, 数据寄存器空很正常, 不进行检测) */</span></div>
<div class="line">    <span class="comment">/* STM32向EEPROM发送WordAddress */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bd9e70b8eafde0dd5eb42b0d95fe1a9">I2C_SendData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, WordAddress);</div>
<div class="line">    <span class="comment">/* 等待EV8事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga037ac1e67e44ee085acac6f034bd73b2">I2C_EVENT_MASTER_BYTE_TRANSMITTING</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line">  <span class="comment">/*---------------- STM32接收Data ----------------*/</span></div>
<div class="line">    <span class="comment">/* STM32另外产生一个START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gaeef8c22ac035122b06e31b360ac7aeb3">I2C_EVENT_MASTER_MODE_SELECT</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的读地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga61da15dd7fd993a66da6d35f16182280">EEPROM_I2C_READ_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#gafe3b9b98552980ca56c8e21a90040fa0">I2C_Direction_Receiver</a>);</div>
<div class="line">    <span class="comment">/* 等待EV6事件(接收)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#gabfde82864432ddb87b6462234d542e60">I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/*------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">    * 注意: </span></div>
<div class="line"><span class="comment">    * 该部分为STM32接收来自EEPROM的数据</span></div>
<div class="line"><span class="comment">    * 接收数据部分, 硬件会自动进行接收, 软件编程时无需操作</span></div>
<div class="line"><span class="comment">    * I2C_ReceiveData函数只是返回I2Cx上最近接收到的数据</span></div>
<div class="line"><span class="comment">    * 而不是进行数据接收</span></div>
<div class="line"><span class="comment">    *------------------------------------------------------------------------*/</span></div>
<div class="line">    <span class="keywordflow">while</span>(NumByteToRead)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (NumByteToRead == 1) <span class="comment">/* 如果为最后一个字节, 产生NO ACK响应 */</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">/* STM32产生NO ACK响应 */</span></div>
<div class="line">            <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1ad3a9df141be0ccf10389b640f492b26d">DISABLE</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* 监测到EV7事件发生, 说明接收到了新数据 */</span></div>
<div class="line">        <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga2d5701342f9d4c1f09bf9d3cdcacc326">I2C_CheckEvent</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___events.html#ga6bcf2ae49961e07e27cf9fdf334719e3">I2C_EVENT_MASTER_BYTE_RECEIVED</a> ) == <a class="code hl_enumvalue" href="group___exported__types.html#gga8333b96c67f83cba354b3407fcbb6ee8a2fd6f336d08340583bd620a7f5694c90">ERROR</a>)</div>
<div class="line">        {</div>
<div class="line">            </div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* 将接收到的数据赋值给Data变量 */</span></div>
<div class="line">        *Data = <a class="code hl_function" href="group___i2_c___exported___functions.html#gaeaaa4b6f77f50eb57465148c55d27fb2">I2C_ReceiveData</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>);</div>
<div class="line">        <span class="comment">/* Data 指针自增 */</span></div>
<div class="line">        Data++;</div>
<div class="line">        <span class="comment">/* NumByteToRead递减 */</span></div>
<div class="line">        NumByteToRead--;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32产生STOP信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* STM32使能ACK信号, 恢复到默认状态 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga7bb44e894d68a7991f564c43fb187486">I2C_AcknowledgeConfig</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>在bsp_i2c.c中编写确认询问函数</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">    <span class="comment">/* STM32产生START信号 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga36c522b471588be9779c878222ccb20f">I2C_GenerateSTART</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">    <span class="comment">/* 等待EV5事件完成, SB=1(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="keywordflow">while</span>(<a class="code hl_function" href="group___i2_c___exported___functions.html#ga15c95d0ed124f029621a2061b1677ee7">I2C_GetFlagStatus</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c__flags__definition.html#gae009ab84be03fcc438625b1c39376ad4">I2C_FLAG_SB</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a>)</div>
<div class="line">    {</div>
<div class="line">       ;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* STM32发送EEPROM的写地址 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga009fc2a5b2313c36da39ece39a1156a6">I2C_Send7bitAddress</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#gaf1f21d11fb28ed3ee6d6fb2a281d3b48">EEPROM_I2C_WRITE_ADDRESS</a>, <a class="code hl_define" href="group___i2_c__transfer__direction.html#ga9895ee2d7d8cc8ba4daafafa1c3ce1ac">I2C_Direction_Transmitter</a>);</div>
<div class="line">    } <span class="keywordflow">while</span> (<a class="code hl_function" href="group___i2_c___exported___functions.html#ga15c95d0ed124f029621a2061b1677ee7">I2C_GetFlagStatus</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_define" href="group___i2_c__flags__definition.html#ga5472d1196e934e0cc471aba8f66af416">I2C_FLAG_ADDR</a>) == <a class="code hl_enumvalue" href="group___exported__types.html#gga89136caac2e14c55151f527ac02daaffa589b7d94a3d91d145720e2fed0eb3a05">RESET</a>); </div>
<div class="line">    <span class="comment">/* 循环监测EV6事件(ADDR=1)(接收)完成(未设置检测时间超时, 不严谨) */</span></div>
<div class="line">    <span class="comment">/* 结束轮询 */</span></div>
<div class="line">    <a class="code hl_function" href="group___i2_c___exported___functions.html#ga5c92cb573ca0ae58cc465e5400246561">I2C_GenerateSTOP</a>(<a class="code hl_define" href="group___i2_c___e_e_p_r_o_m___define.html#ga0cd00a4152e739294a3ba0384ad1d110">EEPROM_I2C</a>, <a class="code hl_enumvalue" href="group___exported__types.html#ggac9a7e9a35d2513ec15c3b537aaa4fba1a7d46875fa3ebd2c34d2756950eda83bf">ENABLE</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>在main.c中进行读写测试</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/* Includes ------------------------------------------------------------------*/</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="stm32f10x_8h.html">stm32f10x.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="stm32f10x__conf_8h.html">stm32f10x_conf.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bsp__led_8h.html">bsp_led.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bsp__usart_8h.html">bsp_usart.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="bsp__i2c_8h.html">bsp_i2c.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> * 操作流程:</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * 1. 初始化I2C相关的GPIO</span></div>
<div class="line"><span class="comment"> * 2. 配置I2C外设的工作模式</span></div>
<div class="line"><span class="comment"> * 3. 编写I2C写入EEPROM的Byte Write函数 </span></div>
<div class="line"><span class="comment"> * 4. 编写I2C读取EEPROM的Random Read函数</span></div>
<div class="line"><span class="comment"> * 5. 使用read函数和write函数进行读写校验</span></div>
<div class="line"><span class="comment"> * 6. 编写Page Write和Sequential Read函数进行校验</span></div>
<div class="line"><span class="comment"> *----------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line">uint8_t <a class="code hl_variable" href="group___global___values.html#ga4288b33b9d46a73b021d937a356fd3d9">ReadData</a>[20] = {0};</div>
<div class="line">uint8_t <a class="code hl_variable" href="group___global___values.html#ga1ba3f553c02cdf96b4f93edade2268e2">WriteData</a>[3] = {3, 4, 5};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* 初始化USART */</span></div>
<div class="line">    <a class="code hl_function" href="bsp__usart_8c.html#ae9720bf2dbb461c28e0205b050f1a0bb">USART_Config</a>(); </div>
<div class="line">    <span class="comment">/* 串口打印 */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;I2C-EEPROM\n&quot;</span>);</div>
<div class="line">    <span class="comment">/* 初始化I2C */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gab5bae292a1facbc179f516fe0e0e4ac1">I2C_EEPROM_Config</a>();</div>
<div class="line">    <span class="comment">/* STM32向EEPROM 地址1写入数据0x01 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga33740ba02658e771d858f42c6b7b3d67">EEPROM_Byte_Writting</a>(1, 0x01);</div>
<div class="line">    <span class="comment">/* ACKNOWLEDGE POLLING 确认询问 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>();</div>
<div class="line">    <span class="comment">/* STM32向EEPROM 地址2写入数据0x02 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga33740ba02658e771d858f42c6b7b3d67">EEPROM_Byte_Writting</a>(2, 0x02);</div>
<div class="line">    <span class="comment">/* ACKNOWLEDGE POLLING 确认询问 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>();</div>
<div class="line">    <span class="comment">/*----------------------------------------</span></div>
<div class="line"><span class="comment">     * Page Writting的地址对齐</span></div>
<div class="line"><span class="comment">     * 为保证数据无误需addr%8 == 0</span></div>
<div class="line"><span class="comment">     *----------------------------------------*/</span> </div>
<div class="line">    <span class="comment">/* STM32向EEPROM 地址3-5写入数据0x03-0x05 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga70eb0aa7e550f51254258a3310f6f77e">EEPROM_Page_Writting</a>(0x03, <a class="code hl_variable" href="group___global___values.html#ga1ba3f553c02cdf96b4f93edade2268e2">WriteData</a>, 3);</div>
<div class="line">    <span class="comment">/* ACKNOWLEDGE POLLING 确认询问 */</span></div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#gaf5d3ddab1426e9d24aa6d7228014a9c3">EEPROM_ACK_Polling</a>();</div>
<div class="line">    <span class="comment">/* STM32从EEPROM以SequentialRead方式读取地址1-4的数据 */</span> </div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga27a269cc6003df0b32491a8e1a02dcba">EEPROM_Sequential_Read</a>((uint8_t)1, <a class="code hl_variable" href="group___global___values.html#ga4288b33b9d46a73b021d937a356fd3d9">ReadData</a>, 4);</div>
<div class="line">    <span class="comment">/* STM32从EEPROM以RandomRead方式读取地址5的数据 */</span> </div>
<div class="line">    <a class="code hl_function" href="group___e_e_p_r_o_m___i2_c___functions.html#ga2a5fa1080d0629291afb76666167c6fd">EEPROM_Random_Read</a>((uint8_t)5, &amp;<a class="code hl_variable" href="group___global___values.html#ga4288b33b9d46a73b021d937a356fd3d9">ReadData</a>[4]);</div>
<div class="line">    <span class="comment">/* 将读出的数据循环打印 */</span></div>
<div class="line">    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; 5; i++)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;ReadData[%d] = 0x%x\n&quot;</span>, i, <a class="code hl_variable" href="group___global___values.html#ga4288b33b9d46a73b021d937a356fd3d9">ReadData</a>[i]);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* 空循环 */</span></div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">    {</div>
<div class="line">        ;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="absp__i2c_8h_html"><div class="ttname"><a href="bsp__i2c_8h.html">bsp_i2c.h</a></div><div class="ttdoc">这个文件包含了I2C函数的声明</div></div>
<div class="ttc" id="absp__led_8h_html"><div class="ttname"><a href="bsp__led_8h.html">bsp_led.h</a></div></div>
<div class="ttc" id="absp__usart_8c_html_ae9720bf2dbb461c28e0205b050f1a0bb"><div class="ttname"><a href="bsp__usart_8c.html#ae9720bf2dbb461c28e0205b050f1a0bb">USART_Config</a></div><div class="ttdeci">void USART_Config(void)</div><div class="ttdoc">USART GPIO 配置,工作参数配置</div><div class="ttdef"><b>Definition</b> bsp_usart.c:33</div></div>
<div class="ttc" id="absp__usart_8h_html"><div class="ttname"><a href="bsp__usart_8h.html">bsp_usart.h</a></div></div>
<div class="ttc" id="agroup___global___values_html_ga1ba3f553c02cdf96b4f93edade2268e2"><div class="ttname"><a href="group___global___values.html#ga1ba3f553c02cdf96b4f93edade2268e2">WriteData</a></div><div class="ttdeci">uint8_t WriteData[3]</div><div class="ttdef"><b>Definition</b> main.c:39</div></div>
<div class="ttc" id="agroup___global___values_html_ga4288b33b9d46a73b021d937a356fd3d9"><div class="ttname"><a href="group___global___values.html#ga4288b33b9d46a73b021d937a356fd3d9">ReadData</a></div><div class="ttdeci">uint8_t ReadData[20]</div><div class="ttdef"><b>Definition</b> main.c:38</div></div>
<div class="ttc" id="amain_8c_html_a840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdoc">STM32与EEPROM通过I2C协议进行读写测试</div><div class="ttdef"><b>Definition</b> main.c:51</div></div>
<div class="ttc" id="astm32f10x_8h_html"><div class="ttname"><a href="stm32f10x_8h.html">stm32f10x.h</a></div><div class="ttdoc">CMSIS Cortex-M3 Device Peripheral Access Layer Header File. This file contains all the peripheral reg...</div></div>
<div class="ttc" id="astm32f10x__conf_8h_html"><div class="ttname"><a href="stm32f10x__conf_8h.html">stm32f10x_conf.h</a></div></div>
</div><!-- fragment --><p>串口实验现象</p>
<p><img src="https://raw.githubusercontent.com/See-YouL/MarkdownPhotos/main/202401280831099.png" alt="实验现象" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
